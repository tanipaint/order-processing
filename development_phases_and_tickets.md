# 開発フェーズ＆チケット一覧

以下のようにフェーズごとにチケットを分割すると、並行開発や担当の切り分けがしやすくなります。

## 🚩 フェーズ１：プロジェクト基盤＆PoC 準備

**状態表示:** 完了(✔)／未着手( )

| チケット番号 | タイトル                          | 概要                                                     | 担当目安         | 状態 |
| :----------: | :-------------------------------- | :------------------------------------------------------- | :--------------- | :--: |
|     1–1      | リポジトリ構成設計                | ディレクトリ構成・モジュール分割方針をドキュメント化     | PM／アーキテクト |  ✔️  |
|     1–2      | Docker イメージ／ローカル環境整備 | Dockerfile／docker-compose／依存ライブラリのインストール | infra            |  ✔️  |
|     1–3      | CI/CD パイプライン骨格構築        | GitHub Actions や GitLab CI でビルド＆基本テスト自動化   | infra            |  ✔️  |
|     1–4      | Lint／Formatter／Pre-commit 設定  | Black／isort／flake8 などの設定と動作確認                | infra            |  ✔️  |
|     1–5      | テスト整備                          | 全テストの不整合解消およびテストケース追加・メンテナンス | backend／qa      | ✔️  |
|     1–6      | 既存テスト/スタイル整備             | 既存のテスト・flake8/Black エラー解消                     | backend／qa      | ✔️   |

## 🚩 フェーズ２：注文抽出（OCR ＋ LLM）PoC

**状態表示:** 完了(✔)／未着手( )

| チケット番号 | タイトル                                 | 概要                                                                       | 担当目安 | 状態 |
| :----------: | :--------------------------------------- | :------------------------------------------------------------------------- | :------- | :--: |
|     2–1      | メール受信インターフェース（スタブ実装） | テスト用に「メール受信データ（添付 PDF／本文）」を読み込むスタブモジュール | backend  |  ✔️  |
|     2–2      | OCR 処理モジュール（Tesseract／スタブ）  | Tesseract 呼び出しラッパー実装と出力仕様定義                               | backend  |  ✔️  |
|     2–3      | LLM 抽出プロンプト設計＆呼び出しラッパー | OpenAI GPT-4o へのプロンプト雛形設計とレスポンスパース処理                 | backend  |  ✔️  |
|     2–4      | 構造化データ変換コンポーネント           | LLM レスポンス(JSON) → 注文オブジェクト変換ロジック                        | backend  |  ✔️  |
|     2–5      | 単体テスト＆サンプルデータ作成           | OCR／LLM スタブ＋サンプル注文メッセージでユニットテスト                    | backend  |  ✔️  |
|     2–6      | LLMベースの注文抽出機能実装               | OpenAI GPT-4o を用いた JSON 形式注文抽出パイプライン実装                  | backend  | ✔️   |
|     2–7      | マルチ商品注文抽出対応                    | 複数商品のライン項目をJSONで抽出しitemsリストを返却する機能を実装          | backend  |  ✔️  |

## 🚩 フェーズ３：Slack 承認ワークフロー実装

**状態表示:** 完了(✔)／未着手( )

| チケット番号 | タイトル                                   | 概要                                                                           | 担当目安       | 状態 |
| :----------: | :----------------------------------------- | :----------------------------------------------------------------------------- | :------------- | :--: |
|     3–1      | Slack Bot 基盤セットアップ                 | Bolt for Python 初期設定／OAuth スコープ設定／イベント受信用エンドポイント配置 | infra／backend |  ✔️  |
|     3–2      | 注文通知メッセージフォーマット設計         | Block Kit による注文通知メッセージフォーマット設計と payload ビルダー実装      | backend        |  ✔️  |
|     3–2      | 注文通知メッセージフォーマット設計         | 仕様書に沿った Block Kit メッセージ雛形作成                                    | backend        |  ✔️  |
|     3–3      | 承認／差し戻しボタンハンドラ実装           | interactive コンポーネント受信 → ステータス更新処理                            | backend        |  ✔️  |
|     3–4      | Slack 上の状態管理（承認者記録・ログ取得） | 承認者情報やタイムスタンプを保持し、Slack 上に反映                             | backend        |  ✔️  |
|     3–5      | E2E テスト（モック Slack API）             | Slack SDK モックによる自動テスト                                               | backend／qa    |  ✔️  |
|     3–6      | Slack 承認後の注文登録連携                 | 承認ボタン押下イベントでNotionへの注文登録・在庫更新処理を呼び出し実装           | backend        |  ✔️  |
|     3–7      | Slackモーダルによる注文内容確認UI実装      | 抽出結果の修正・承認を可能にする Block Kit Modal フローを実装               | backend        | ✔️   |
|     3–8      | Slack 複数商品通知対応                     | Block Kit メッセージフォーマットを複数商品用に拡張                          | backend        | ✔️   |

## 🚩 フェーズ４：Notion 連携＆在庫更新・DB 登録

| チケット番号 | タイトル                                                | 概要                                                             | 担当目安    |
| :----------: | :------------------------------------------------------ | :--------------------------------------------------------------- | :---------- | --- |
|     4–1      | Notion API クライアントラッパー実装                     | products/customers/orders 各エンドポイント呼び出し基盤           | backend     | ✔️  |
|     4–2      | 在庫参照＆残数チェックロジック                          | products テーブルから在庫数取得・不足判定                        | backend     | ✔️  |
|     4–3      | 注文登録／在庫更新トランザクション処理                  | orders 登録＋ products の stock マイナス更新を原子性を保って実装 | backend     | ✔️  |
|     4–4      | Notion 連携の単体テスト                                 | Notion API のモックを使ったユニットテスト                        | backend／qa | ✔️  |
|     4–5      | 差し戻し時の自動返信メール（オプション）                | 差し戻し理由を組み込んだメールテンプレート作成／送信             | backend     | ✔️  |
|     4–6      | 顧客自動登録ロジック実装                              | customers テーブルに存在しない顧客を新規作成                       | backend     | ✔️  |
|     4–7      | products テーブルへのサンプル商品一括登録スクリプト実装 | products データを Notion に自動投入するスクリプト                | backend     | ✔️  |
|     4–8      | customers テーブルへのCSV一括登録スクリプト実装       | doc/customers.csv から customers データ一括投入スクリプト         | backend     | ✔️  |
|     4–9      | orders テーブルへのCSV一括登録スクリプト実装         | doc/orders.csv から orders データ一括投入スクリプト               | backend     | ✔️  |

## 🚩 フェーズ５：自動返信（メール／LINE）

| チケット番号 | タイトル                                   | 概要                                                                 | 担当目安 | 状態 |
|:-----------:|:------------------------------------------|:----------------------------------------------------------------------|:--------:|:----:|
| 5–1         | メール送信クライアント実装                | SMTP 経由で自動返信メールを送信                                       | backend  | ✔️   |
| 5–2         | 注文承認時の自動返信メール送信ロジック実装 | 注文承認後に顧客へ確認メールを送信                                     | backend  | ✔️   |
| 5–3         | 差し戻し理由を組み込んだ自動返信メール実装 | 差し戻し時に差し戻し理由を含むメールテンプレートを送信                | backend  |      |
| 5–4         | LINE 自動返信クライアント実装             | LINE API 経由で自動返信メッセージを送信                                | backend  |      |

## 🚩 フェーズ６：RAG を使った表記揺れ補正

| チケット番号 | タイトル                                         | 概要                                                              | 担当目安   | 状態 |
|:-----------:|:------------------------------------------------|:-----------------------------------------------------------------|:----------:|:----:|
| 6–1         | FAISS ベースのベクトル検索器実装                | 商品・顧客名称辞書を用いたベクトルストアを構築                    | backend    | ✔️   |
| 6–2         | RAG 用プロンプト＆パイプライン実装              | LLM に渡すプロンプトテンプレートとクエリ結果の後処理を実装        | backend    | ✔️   |
| 6–3         | 商品名の表記揺れ補正ロジック実装                | RAG を用いてユーザー入力商品名を正規化し、商品マスタの id を返す   | backend    | ✔️   |
| 6–4         | 顧客名の表記揺れ補正ロジック実装                | RAG を用いて顧客名のゆらぎを補正し、顧客マスタの name を返す       | backend    | ✔️   |
| 6–5         | RAG に対する単体テスト                          | FAISS インデックスの検索結果と整形ロジックのユニットテスト整備    | backend／qa| ✔️   |
| 6–6         | 辞書同期＆ベクトル検索パイプライン実装         | products.md/customer.md を埋め込み化し Faiss で表記ゆらぎ補正               | backend    |      |

## 🚩 フェーズ７：メール受信リスナー実装

| チケット番号 | タイトル                                   | 概要                                                                 | 担当目安 | 状態 |
|:-----------:|:------------------------------------------|:----------------------------------------------------------------------|:--------:|:----:|
| 7–1         | IMAP/POP3 メール受信リスナー実装          | imaplib 等を使い、新着メールをポーリングまたは IDLE で監視              | backend  | ✔️   |
| 7–2         | メール本文パースロジック実装              | MIME マルチパートからテキスト部分を抽出し、注文抽出フローへ渡す        | backend  | ✔️   |
| 7–3         | メール受信フロー E2E テスト               | 実際のメール受信からログ出力までの一連処理を確認するテスト             | backend/qa|      |
| 7–4         | メール受信→Slack通知ブリッジ実装          | IMAP受信→注文抽出→在庫チェック→Slack通知を定期実行                    | backend  | ✔️   |

## 🚩 フェーズ８：自動返信（メール／LINE）

| チケット番号 | タイトル                                   | 概要                                                                 | 担当目安 | 状態 |
|:-----------:|:------------------------------------------|:----------------------------------------------------------------------|:--------:|:----:|
| 8–1         | メール送信クライアント実装                | SMTP 経由で自動返信メールを送信                                       | backend  | ✔️   |
| 8–2         | 注文承認時の自動返信メール送信ロジック実装 | 注文承認後に顧客へ確認メールを送信                                     | backend  | ✔️   |
| 8–3         | 差し戻し理由を組み込んだ自動返信メール実装 | 差し戻し時に差し戻し理由を含むメールテンプレートを送信                | backend  |      |
| 8–4         | LINE 自動返信クライアント実装             | LINE API 経由で自動返信メッセージを送信                                | backend  |      |

## 🚩 フェーズ９：外部 EC システム連携（Shopify／BASE）

| チケット番号 | タイトル                              | 概要                                               | 担当目安 | 状態 |
|:-----------:|:-------------------------------------|:--------------------------------------------------|:--------:|:----:|
| 9–1         | Shopify EC 連携                       | Shopify API を用いて注文・在庫情報の同期           | backend  |      |
| 9–2         | BASE EC 連携                          | BASE API を用いて注文・在庫情報の同期              | backend  |      |

## 🚩 フェーズ１０：本番環境デプロイ＆監視設定

| チケット番号 | タイトル                                    | 概要                                    | 担当目安 | 状態 |
|:-----------:|:--------------------------------------------|:---------------------------------------|:--------:|:----:|
|10–1         | 本番環境デプロイ設定(GCP/AWS)               | CD の設定とロードバランサ構成          | infra    |      |
|10–2         | モニタリング・アラート設定                  | Prometheus/Grafana でメトリクス監視    | infra    |      |
|    4–10      | order_details テーブルへのCSV一括登録スクリプト実装   | doc/order_details.csv から明細データ一括投入スクリプト            | backend     |      |
|     2–8      | LLM抽出のマルチ商品対応強化               | プロンプトと後処理を改修し、LLM経路でもitemsリストを取得可能にする         | backend  |      |
|     2–9      | PDFテーブル抽出ロジック改良               | 正規表現ベースのテーブルパーサーを実装し、複数商品の明細を確実に抽出        | backend  |      |
|    2–10      | PDF表抽出基盤実装                        | Camelot/pdfplumberによる表領域検出と汎用テーブルパーサーを導入              | backend  |      |
|    2–11      | LLMテーブル抽出プロンプト強化              | LLMに全行テーブル形式を認識させ、行ごとにJSON抜出するプロンプトを実装       | backend  |      |
